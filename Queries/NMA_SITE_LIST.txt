SELECT 
        DINV.DEV_ID, 
        DINV.LONG_CLLI, 
        DINV.SITE_ID, 
        DINV.MNFCTR_MODEL as EQUIPMENT_TYPE, 
        SUBSTR(DINV.MNFCTR_MODEL, 1, INSTR(DINV.MNFCTR_MODEL, ' ')) AS Vendor,
        UPPER(DINV.DEV_HOST_CLLI) DEV_HOST_CLLI,
        SITE.SITE_NME , 
        SITE.SITE_CLLI, 
        SITE.EXCH_NME, 
        SITE.HOUSING, 
        SITE.LAT_NBR, 
        SITE.LONG_NBR, 
        SITE.ADRS_VAL ||', '||SITE.CITY||', '||SITE.ST_CD||', '||SITE.ZIP AS ADDRESS, 
        SITE.CITY,
        SITE.ST_CD,
        SITE.ZIP,
        SITE.E911_ADRS, 
        SITE.SITE_COUNTY, 
        DINV.IP_ADDRESS, 
        COALESCE(SITE.SITE_CLLI,SITE.SITE_WIRE_CTR,  WC.WIRE_CENTER_CD) AS WIRE_CENTER,
        SITE.SRC_META_CURR_IND,
        SITE.UNR_REG_SITE,
        SITE.GLM_SITE_ID,
        SITE.CNTY_PARSH,
        DINV.GLM_LOCATION_ID,
        SITE.SITE_WORK_CTR,
        WC.T_CO_ID,
        WC.EXCHANGE_CD,
        WC.COMPANY_ID, 
        GL1.GL_SEG1_COMPANY_ODS_ID,
        GL1.GL_SEG1_COMPANY_KEY_ID, 
        GL1.GL_COMPANY_ODS_ID



FROM `da-prod-dwh-dw01.AV_STAGE.WFMT_DEV_INVTRY_AV` DINV
LEFT JOIN `da-prod-dwh-dw01.AV_STAGE.WFMT_DEV_SITES_AV` SITE ON
SITE.SITE_ID=DINV.SITE_ID
LEFT JOIN `da-prod-dwh-dw01.AV_STAGE.WFMT_WIRE_CENTER_AV` WC ON
WC.WIRE_CENTER_CD=SITE.SITE_WIRE_CTR
LEFT JOIN `da-prod-dwh-dw01.AV_CODS_FINANCE.GL_SEG1_COMPANY_AV` GL1 
ON GL1.GL_OPER_COMPANY_CD=WC.T_CO_ID



WHERE SITE.SRC_META_CURR_IND='Y' AND SITE.SITE_NME != "OSP PROJ" AND DINV.MNFCTR_MODEL != "OSP PROJECT" AND SITE.SITE_WIRE_CTR !='fictitous' AND  SITE.ADRS_VAL !='fictitious'
Order by DINV.LONG_CLLI

